@import "./variables.less";
@import (reference) "../../input/style/variables.less";
@import (reference) "../../icon/style/variables.less";

.@{select-prefix} {
	.appearance();
	.touch-action();
	.outline();

	.input(inline-flex);
	min-width: calc(5ch + (@input-padding-x * 2) + @input-padding-y + @font-size-large + (@border-width-medium * 2));
	justify-content: space-between;
	align-items: center;
	gap: @input-padding-y;
	cursor: pointer;

	& .@{icon-prefix} {
		transform: translateZ(0) scale(unit(@font-size-large));
	}

	&-text {
		flex: 1;
		font-size: inherit;
		color: inherit;
		line-height: @line-height;
		white-space: nowrap;
		text-overflow: ellipsis;
		text-align: left;
		overflow: hidden;
	}

	&-placeholder {
		color: var(--text-placeholder);
	}

	& + &-clear {
		position: absolute;
		top: (@input-padding-y + 0.25em);
		right: calc(@input-padding-x + @border-width-medium);
		z-index: 2;
	}

	@media (hover: hover) {
		&:not(:hover) + .@{select-prefix}-clear:not(:hover):not([hidden]) {
			opacity: 0;
		}
	}

	&-portal {
		z-index: @z-index-dropdown;
	}

	&-wrapper {
		position: relative;
		display: inline-block;
		z-index: 1;
	}

	&-list {
		display: block;
		min-width: inherit;
		// Show a max of 4 options plus half an option to hint at there being more when you scroll.
		max-height: (((unit(@line-height, em) + @input-padding-y * 2) * 4.5) + @input-padding-y * 2 + @select-option-spacing * 4);
		padding: @input-padding-y;
		margin-top: @outline-width;
		background-color: var(--select-bg-list);
		border-radius: @select-list-border-radius;
		font-size: 1em;
		box-shadow: @shadow-extra;
		overflow-y: auto;
		overflow-x: hidden;
		overscroll-behavior-y: contain;
		box-sizing: content-box;
	}

	&-option {
		.user-select();
		.touch-action();

		display: block;
		padding: @input-padding-y @input-padding-x;
		background-color: transparent;
		border-radius: @select-list-border-radius;
		color: var(--select-color);
		font-size: @font-size-medium;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		cursor: pointer;
		outline: none;
		transition: @transition-speed-fast @transition-easing;
		transition-property: color, background-color;

		&:hover,
		&:focus,
		&-hover:not([aria-selected="true"]) {
			background-color: var(--select-bg-option-hover);
		}

		&:active {
			background-color: var(--select-bg-option-active);
		}

		& + .@{select-prefix}-option {
			margin-top: @select-option-spacing;
		}

		& .@{icon-prefix} {
			margin-right: @input-padding-y;
			transform: translateZ(0) scale(unit(@font-size-large));
		}

		& * {
			pointer-events: none;
		}

		&-hover {
			transition-duration: 0s;
		}

		&[aria-selected="true"] {
			color: var(--select-color-selected);
			background-color: var(--select-bg-option-selected);

			&:hover,
			&:focus,
			&.@{select-prefix}-option-hover {
				background-color: var(--select-bg-option-selected-hover);
			}

			&:active {
				background-color: var(--select-bg-option-selected-active);
			}
		}

		&[aria-disabled="true"] {
			color: var(--input-color-disabled);
			background-color: var(--input-bg-disabled);
			cursor: not-allowed;
		}
	}

	&[aria-expanded="true"] {
		background-color: var(--input-bg-active);
		border-color: var(--input-border-active);
		box-shadow: @input-shadow-focus;
	}
}
